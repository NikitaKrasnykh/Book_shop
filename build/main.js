(()=>{"use strict";const e=e=>e.ok?e.json():e.json().then((e=>Promise.reject(e.message)));function t(t,o=0){return fetch(`https://www.googleapis.com/books/v1/volumes?q="subject:${t}"&key=AIzaSyAw8dYZxnbBh_ADDcduDpF3PWGRAcIqC14&printType=books&startIndex=${o}&maxResults=6&langRestrict=en`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e)}const o=[{src:"./src/images/banner_01.png",alt:"first banner"},{src:"./src/images/banner_02.png",alt:"second banner"},{src:"./src/images/banner_03.png",alt:"third banner"}],n=document.querySelectorAll(".banner__radio-button"),r=document.querySelector(".banner__image");let s=0,l=setInterval(c,5e3);function i(e,t){n[s].classList.remove("banner__radio-button_type_selected"),r.src=e[t].src,r.alt=e[t].alt,n[t].classList.add("banner__radio-button_type_selected"),s=t}function c(){i(o,s===o.length-1?0:s+1)}i(o,s),n.forEach((e=>{e.addEventListener("click",(()=>{clearInterval(l),i(o,Number(e.dataset.index)),l=setInterval(c,5e3)}))}));const a=document.querySelector(".header__items-count");let u=localStorage.getItem("boughtBooks")?JSON.parse(localStorage.getItem("boughtBooks")):[];function d(){u.length>0?(a.textContent=u.length,a.style.display="block"):a.style.display="none"}function _(e){return u.includes(e)}d();const b=document.querySelector(".books__cards");function y(e){e.forEach((e=>{const t=document.querySelector("#card__template").content.querySelector(".book__card").cloneNode(!0),o=t.querySelector(".book__img"),n=t.querySelector(".book__author"),r=t.querySelector(".book__name"),s=t.querySelector(".book__review-count"),l=t.querySelectorAll(".book__review-star"),i=t.querySelector(".book__review-container"),c=t.querySelector(".book__description"),a=t.querySelector(".book__price"),y=t.querySelector(".book__buy-button");for(let t=0;t<l.length;t++){let o=l[t].querySelector("#half_grad"),n=l[t].querySelector("#color_path");o.setAttribute("id",`${e.id}${[t]}`),n.setAttribute("fill",`url(#${e.id}${[t]})`)}e.volumeInfo.imageLinks?o.src=e.volumeInfo.imageLinks.thumbnail:o.src="./src/images/book_default.png",n.textContent=e.volumeInfo.authors.join(", "),r.textContent=e.volumeInfo.title,e.volumeInfo.ratingsCount?s.textContent=`${e.volumeInfo.ratingsCount} review(s)`:s.textContent="",function(e,t,o){if(e.volumeInfo.averageRating){let o=Number(e.volumeInfo.averageRating);for(let e=0;e<=4;e++){if(!(o>=e)){let n=100*(e-o);t[e].querySelector("#starFill").setAttribute("offset",`${n}%`);break}t[e].querySelector("#starFill").setAttribute("offset","100%")}}else o.style.visibility="hidden"}(e,l,i),c.textContent=e.volumeInfo.description,e.saleInfo.retailPrice?a.textContent=e.saleInfo.retailPrice:a.style.visibility="hidden",y.addEventListener("click",(()=>{!function(e,t){var o;_(e.id)?(function(e){if(u.includes(e)){let t=u.indexOf(e);u=u.toSpliced(t,1),localStorage.setItem("boughtBooks",JSON.stringify(u)),d()}}(e.id),t.classList.remove("book__buy-button_type_pressed"),t.textContent="buy now"):(o=e.id,u.includes(o)||(u.push(o),localStorage.setItem("boughtBooks",JSON.stringify(u)),d()),t.classList.add("book__buy-button_type_pressed"),t.textContent="in the cart")}(e,y)})),_(e.id)&&(y.classList.add("book__buy-button_type_pressed"),y.textContent="in the cart"),b.append(t)}))}const m=document.querySelector(".book__more-button"),g=document.querySelectorAll(".books__menu-button"),f=document.querySelectorAll(".books__menu-item");let p,h;function k(e,t){p=e.dataset.type,h=t.length}t(g[0].dataset.type).then((e=>{let t=e.items;6===t.length&&(m.style.display="block"),y(t),k(g[0],t)})),g.forEach((e=>{e.addEventListener("click",(()=>{b.innerHTML="",p="",h=0,f.forEach((e=>{e.classList.remove("books__menu-item_type_selected")})),e.parentElement.classList.add("books__menu-item_type_selected"),t(e.dataset.type).then((t=>{let o=t.items;6===o.length&&(m.style.display="block"),y(o),k(e,o)}))}))})),m.addEventListener("click",(()=>{t(p,h).then((e=>{let t=e.items;t.length<6&&(m.style.display="none"),y(t),h+=t.length}))}))})();